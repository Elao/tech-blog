
This is a small post to explain to you how to simply share objects when you write your fixtures on Symfony2.

Let&#8217;s assume you have 2 class,

<div class="codecolorer-container text vibrant" style="overflow:auto;white-space:nowrap;width:100%;">
  <div class="text codecolorer">
    Game
  </div>
</div>

and

<div class="codecolorer-container text vibrant" style="overflow:auto;white-space:nowrap;width:100%;">
  <div class="text codecolorer">
    Platform
  </div>
</div>

linked together as a One to Many relation (one game may have One or Many Platforms).  
How to tell Doctrine2 to link Platform Y to this Game X ?

<div class="codecolorer-container php vibrant" style="overflow:auto;white-space:nowrap;width:100%;">
  <div class="php codecolorer">
    <span class="kw2">namespace</span> Application\SeekTeam2Bundle\DataFixtures\ORM<span class="sy0">;</span><br /> <br /> <span class="kw2">use</span> Application\SeekTeam2Bundle\Entity\Platform<span class="sy0">;</span><br /> <span class="kw2">use</span> Doctrine\Common\DataFixtures\FixtureInterface<span class="sy0">;</span><br /> <span class="kw2">use</span> Application\\SeekTeam2Bundle\Entity\Game<span class="sy0">;</span><br /> <span class="kw2">use</span> Doctrine\Common\DataFixtures\AbstractFixture<span class="sy0">;</span> <span class="co1">// you must add this to be able to use the setReference() /</span><br /> <span class="co1">// getReference() functions we need to share objects</span><br /> <br /> <span class="co1">// Be sure to extend AbstractFixture</span><br /> <span class="kw2">class</span> GameFixtures <span class="kw2">extends</span> AbstractFixture<br /> <span class="br0">&#123;</span><br /> &nbsp; <span class="kw2">public</span> <span class="kw2">function</span> load<span class="br0">&#40;</span><span class="re0">$em</span><span class="br0">&#41;</span><br /> &nbsp; <span class="br0">&#123;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">loadPlatforms</span><span class="br0">&#40;</span><span class="re0">$em</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">loadGames</span><span class="br0">&#40;</span><span class="re0">$em</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; <span class="br0">&#125;</span><br /> <br /> &nbsp; <span class="kw2">public</span> <span class="kw2">function</span> loadPlatforms<span class="br0">&#40;</span><span class="re0">$em</span><span class="br0">&#41;</span><br /> &nbsp; <span class="br0">&#123;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$platform</span> <span class="sy0">=</span> <span class="kw2">new</span> Platform<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'PC'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setSmallImage</span><span class="br0">&#40;</span><span class="st_h">'pc-min.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setImage</span><span class="br0">&#40;</span><span class="st_h">'pc.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="co1">// by using setRerence, you'll be able to use it later when you want to associate this object to</span><br /> &nbsp; &nbsp; <span class="co1">// another one without a single one DB query.</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">setReference</span><span class="br0">&#40;</span><span class="st_h">'pc'</span><span class="sy0">,</span> <span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$platform</span> <span class="sy0">=</span> <span class="kw2">new</span> Platform<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'Xbox 360'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setSmallImage</span><span class="br0">&#40;</span><span class="st_h">'xbox360-min.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setImage</span><span class="br0">&#40;</span><span class="st_h">'xbox360.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">setReference</span><span class="br0">&#40;</span><span class="st_h">'xbox360'</span><span class="sy0">,</span> <span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$platform</span> <span class="sy0">=</span> <span class="kw2">new</span> Platform<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'PS3'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setSmallImage</span><span class="br0">&#40;</span><span class="st_h">'ps3-min.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$platform</span><span class="sy0">-></span><span class="me1">setImage</span><span class="br0">&#40;</span><span class="st_h">'ps3.png'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">setReference</span><span class="br0">&#40;</span><span class="st_h">'ps3'</span><span class="sy0">,</span> <span class="re0">$platform</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><a href="http://www.php.net/flush"><span class="kw3">flush</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> <span class="br0">&#125;</span><br /> <br /> &nbsp; <span class="kw2">public</span> <span class="kw2">function</span> loadGames<span class="br0">&#40;</span><span class="re0">$em</span><span class="br0">&#41;</span><br /> &nbsp; <span class="br0">&#123;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span> <span class="sy0">=</span> <span class="kw2">new</span> Game<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'Counter Strike : Source'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">setDescription</span><span class="br0">&#40;</span><span class="st0">"Counter-Strike: Source blends Counter-Strike's award..."</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="co1">// Here we can add the relation by getting the reference you previously set on the platform object</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">addPlatforms</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-></span><span class="me1">getReference</span><span class="br0">&#40;</span><span class="st_h">'pc'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">setReference</span><span class="br0">&#40;</span><span class="st_h">'css'</span><span class="sy0">,</span> <span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$game</span> <span class="sy0">=</span> <span class="kw2">new</span> Game<span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">setName</span><span class="br0">&#40;</span><span class="st_h">'Crysis 2'</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">setDescription</span><span class="br0">&#40;</span><span class="st0">"It’s 2023, terrifying alien invaders stalk the New York City streets..."</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">addPlatforms</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-></span><span class="me1">getReference</span><span class="br0">&#40;</span><span class="st_h">'pc'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">addPlatforms</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-></span><span class="me1">getReference</span><span class="br0">&#40;</span><span class="st_h">'xbox360'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$game</span><span class="sy0">-></span><span class="me1">addPlatforms</span><span class="br0">&#40;</span><span class="re0">$this</span><span class="sy0">-></span><span class="me1">getReference</span><span class="br0">&#40;</span><span class="st_h">'ps3'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$this</span><span class="sy0">-></span><span class="me1">setReference</span><span class="br0">&#40;</span><span class="st_h">'crysis2'</span><span class="sy0">,</span> <span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><span class="me1">persist</span><span class="br0">&#40;</span><span class="re0">$game</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> &nbsp; &nbsp; <span class="re0">$em</span><span class="sy0">-></span><a href="http://www.php.net/flush"><span class="kw3">flush</span></a><span class="br0">&#40;</span><span class="br0">&#41;</span><span class="sy0">;</span><br /> <br /> &nbsp; <span class="br0">&#125;</span><br /> <span class="br0">&#125;</span>
  </div>
</div>

There is a whole chapter dedicated to Fixtures in the [cookbook][1] where advanced usage is being developped (like Ordered fixtures&#8230;). I strongly advise you to read it, especially if you are a newcomer to Symfony2.

 [1]: http://symfony.com/doc/2.0/cookbook/doctrine/doctrine_fixtures.html